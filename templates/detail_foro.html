
{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/jquery.fancybox.min.css" />

{% endblock extra_css %}

{% block content %}
titulo: {{object.nombre}}

<h1>Aportes</h1>
{% for aporte in object.aportes_set.all %}
{{aporte.contenido|safe}}--{{aporte.usuario}}<br>

comentarios
{% if request.user.is_authenticated %}


<a class="fancybox" data-fancybox data-type="iframe" data-options='{"iframe" : {"css" : {"height" : "600px"}}}' data-src="{% url 'add_comentario' aporte.id %}" href="javascript:;">
	Agregar

</a>
{% endif %}

{% for coment in aporte.comentarios_set.all %}
{{coment.comentario|safe}}
<a class="fancybox" data-fancybox data-type="iframe" data-src="{% url 'editar_comentario' coment.id %}" href="javascript:;">
	Modificar
</a>
{% endfor %}
{% endfor %}

{% if request.user.is_authenticated %}
<h1>Agregar aportes</h1>
<form action="." method="POST" enctype="multipart/form-data">{% csrf_token %}
	{{form.media}}
	{{form.errors}}
	{{form}}
	<input type="submit" name="Agregar aporte" value="Agregar aporte">
</form>
{% endif %}
{% endblock content %}

{% block extra_js %}
<script src="/static/js/jquery.fancybox.min.js"></script>

<script>
$('.fancybox').fancybox({ 
  afterShow: function(){     
    $('.fancybox-iframe').contents().find('input').click(function(){
         window.parent.location.reload();
         window.parent.$.fancybox.close();
     }); 
   }
 });
</script>
{% endblock extra_js %}